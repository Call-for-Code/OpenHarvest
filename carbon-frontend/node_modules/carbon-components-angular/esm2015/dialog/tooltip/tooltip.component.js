/**
 *
 * carbon-angular v0.0.0 | tooltip.component.js
 *
 * Copyright 2014, 2021 IBM
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0

 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


import { Component, TemplateRef, HostBinding, ElementRef, Optional } from "@angular/core";
import { getFocusElementList } from "carbon-components-angular/common";
import { Dialog } from "../dialog.component";
import { position } from "@carbon/utils-position";
import { AnimationFrameService, ElementService } from "carbon-components-angular/utils";
import { closestAttr } from "carbon-components-angular/utils";
/**
 * Extend the `Dialog` component to create a tooltip for exposing content.
 */
export class Tooltip extends Dialog {
    constructor(elementRef, elementService, animationFrameService = null) {
        super(elementRef, elementService, animationFrameService);
        this.elementRef = elementRef;
        this.elementService = elementService;
        this.animationFrameService = animationFrameService;
        this.style = "inline-block";
        /**
         * Value is set to `true` if the `Tooltip` is to display a `TemplateRef` instead of a string.
         */
        this.hasContentTemplate = false;
        /**
         * Sets the role of the tooltip. If there's no focusable content we leave it as a `tooltip`,
         * if there _is_ focusable content we switch to the interactive `dialog` role.
         */
        this.role = "tooltip";
    }
    /**
     * Check whether there is a template for the `Tooltip` content.
     */
    onDialogInit() {
        this.addGap["bottom"] = pos => {
            const adjustedOffset = this.getAdjustOffset();
            return position.addOffset(pos, 3 + adjustedOffset.top, 0 + adjustedOffset.left);
        };
        this.addGap["top"] = pos => {
            const adjustedOffset = this.getAdjustOffset();
            return position.addOffset(pos, -10 + adjustedOffset.top, 0 + adjustedOffset.left);
        };
        this.addGap["left"] = pos => {
            const adjustedOffset = this.getAdjustOffset();
            return position.addOffset(pos, -3 + adjustedOffset.top, -6 + adjustedOffset.left);
        };
        this.addGap["right"] = pos => {
            const adjustedOffset = this.getAdjustOffset();
            return position.addOffset(pos, -3 + adjustedOffset.top, 6 + adjustedOffset.left);
        };
        this.hasContentTemplate = this.dialogConfig.content instanceof TemplateRef;
    }
    getAdjustOffset() {
        const closestWithPos = closestAttr("position", ["relative", "fixed", "absolute"], this.elementRef.nativeElement.parentElement);
        const topPos = closestWithPos ? closestWithPos.getBoundingClientRect().top * -1 : 0;
        const leftPos = closestWithPos ? closestWithPos.getBoundingClientRect().left * -1 : 0;
        return { top: topPos, left: leftPos };
    }
    afterDialogViewInit() {
        const focusableElements = getFocusElementList(this.dialog.nativeElement);
        if (focusableElements.length > 0) {
            this.role = "dialog";
            focusableElements[0].focus();
        }
    }
}
Tooltip.decorators = [
    { type: Component, args: [{
                selector: "ibm-tooltip",
                template: `
		<div
			#dialog
			[id]="dialogConfig.compID"
			[attr.role]="role"
			[attr.data-floating-menu-direction]="placement"
			class="bx--tooltip bx--tooltip--shown">
			<span class="bx--tooltip__caret" aria-hidden="true"></span>
			<ng-template
					*ngIf="hasContentTemplate"
					[ngTemplateOutlet]="dialogConfig.content"
					[ngTemplateOutletContext]="{tooltip: this}">
			</ng-template>
			<p
				*ngIf="!hasContentTemplate">
				{{dialogConfig.content}}
			</p>
		</div>
		`
            }] }
];
/** @nocollapse */
Tooltip.ctorParameters = () => [
    { type: ElementRef },
    { type: ElementService },
    { type: AnimationFrameService, decorators: [{ type: Optional }] }
];
Tooltip.propDecorators = {
    style: [{ type: HostBinding, args: ["style.display",] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9vbHRpcC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9jYXJib24tY29tcG9uZW50cy1hbmd1bGFyL2RpYWxvZy8iLCJzb3VyY2VzIjpbInRvb2x0aXAvdG9vbHRpcC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNOLFNBQVMsRUFDVCxXQUFXLEVBQ1gsV0FBVyxFQUNYLFVBQVUsRUFDVixRQUFRLEVBQ1IsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFFdkUsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzdDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsY0FBYyxFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDeEYsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRTlEOztHQUVHO0FBdUJILE1BQU0sT0FBTyxPQUFRLFNBQVEsTUFBTTtJQVlsQyxZQUNXLFVBQXNCLEVBQ3RCLGNBQThCLEVBQ2xCLHdCQUErQyxJQUFJO1FBQ3pFLEtBQUssQ0FBQyxVQUFVLEVBQUUsY0FBYyxFQUFFLHFCQUFxQixDQUFDLENBQUM7UUFIL0MsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDbEIsMEJBQXFCLEdBQXJCLHFCQUFxQixDQUE4QjtRQWQ1QyxVQUFLLEdBQUcsY0FBYyxDQUFDO1FBQ3JEOztXQUVHO1FBQ0ksdUJBQWtCLEdBQUcsS0FBSyxDQUFDO1FBQ2xDOzs7V0FHRztRQUNJLFNBQUksR0FBRyxTQUFTLENBQUM7SUFPeEIsQ0FBQztJQUVEOztPQUVHO0lBQ0gsWUFBWTtRQUNYLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsR0FBRyxDQUFDLEVBQUU7WUFDN0IsTUFB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XG5cdEhvc3RCaW5kaW5nLFxuXHRFbGVtZW50UmVmLFxuXHRPcHRpb25hbFxufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgZ2V0Rm9jdXNFbGVtZW50TGlzdCB9IGZyb20gXCJjYXJib24tY29tcG9uZW50cy1hbmd1bGFyL2NvbW1vblwiO1xuXG5pbXBvcnQgeyBEaWFsb2cgfSBmcm9tIFwiLi4vZGlhbG9nLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgcG9zaXRpb24gfSBmcm9tIFwiQGNhcmJvbi91dGlscy1wb3NpdGlvblwiO1xuaW1wb3J0IHsgQW5pbWF0aW9uRnJhbWVTZXJ2aWNlLCBFbGVtZW50U2VydmljZSB9IGZyb20gXCJjYXJib24tY29tcG9uZW50cy1hbmd1bGFyL3V0aWxzXCI7XG5pbXBvcnQgeyBjbG9zZXN0QXR0ciB9IGZyb20gXCJjYXJib24tY29tcG9uZW50cy1hbmd1bGFyL3V0aWxzXCI7XG5cbi8qKlxuICogRXh0ZW5kIHRoZSBgRGlhbG9nYCBjb21wb25lbnQgdG8gY3JlYXRlIGEgdG9vbHRpcCBmb3IgZXhwb3NpbmcgY29udGVudC5cbiAqL1xuQENvbXBvbmVudCh7XG5cdHNlbGVjdG9yOiBcImlibS10b29sdGlwXCIsXG5cdHRlbXBsYXRlOiBgXG5cdFx0PGRpdlxuXHRcdFx0I2RpYWxvZ1xuXHRcdFx0W2lkXT1cImRpYWxvZ0NvbmZpZy5jb21wSURcIlxuXHRcdFx0W2F0dHIucm9sZV09XCJyb2xlXCJcblx0XHRcdFthdHRyLmRhdGEtZmxvYXRpbmctbWVudS1kaXJlY3Rpb25dPVwicGxhY2VtZW50XCJcblx0XHRcdGNsYXNzPVwiYngtLXRvb2x0aXAgYngtLXRvb2x0aXAtLXNob3duXCI+XG5cdFx0XHQ8c3BhbiBjbGFzcz1cImJ4LS10b29sdGlwX19jYXJldFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvc3Bhbj5cblx0XHRcdDxuZy10ZW1wbGF0ZVxuXHRcdFx0XHRcdCpuZ0lmPVwiaGFzQ29udGVudFRlbXBsYXRlXCJcblx0XHRcdFx0XHRbbmdUZW1wbGF0ZU91dGxldF09XCJkaWFsb2dDb25maWcuY29udGVudFwiXG5cdFx0XHRcdFx0W25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInt0b29sdGlwOiB0aGlzfVwiPlxuXHRcdFx0PC9uZy10ZW1wbGF0ZT5cblx0XHRcdDxwXG5cdFx0XHRcdCpuZ0lmPVwiIWhhc0NvbnRlbnRUZW1wbGF0ZVwiPlxuXHRcdFx0XHR7e2RpYWxvZ0NvbmZpZy5jb250ZW50fX1cblx0XHRcdDwvcD5cblx0XHQ8L2Rpdj5cblx0XHRgXG59KVxuZXhwb3J0IGNsYXNzIFRvb2x0aXAgZXh0ZW5kcyBEaWFsb2cge1xuXHRASG9zdEJpbmRpbmcoXCJzdHlsZS5kaXNwbGF5XCIpIHN0eWxlID0gXCJpbmxpbmUtYmxvY2tcIjtcblx0LyoqXG5cdCAqIFZhbHVlIGlzIHNldCB0byBgdHJ1ZWAgaWYgdGhlIGBUb29sdGlwYCBpcyB0byBkaXNwbGF5IGEgYFRlbXBsYXRlUmVmYCBpbnN0ZWFkIG9mIGEgc3RyaW5nLlxuXHQgKi9cblx0cHVibGljIGhhc0NvbnRlbnRUZW1wbGF0ZSA9IGZhbHNlO1xuXHQvKipcblx0ICogU2V0cyB0aGUgcm9sZSBvZiB0aGUgdG9vbHRpcC4gSWYgdGhlcmUncyBubyBmb2N1c2FibGUgY29udGVudCB3ZSBsZWF2ZSBpdCBhcyBhIGB0b29sdGlwYCxcblx0ICogaWYgdGhlcmUgX2lzXyBmb2N1c2FibGUgY29udGVudCB3ZSBzd2l0Y2ggdG8gdGhlIGludGVyYWN0aXZlIGBkaWFsb2dgIHJvbGUuXG5cdCAqL1xuXHRwdWJsaWMgcm9sZSA9IFwidG9vbHRpcFwiO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByb3RlY3RlZCBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuXHRcdHByb3RlY3RlZCBlbGVtZW50U2VydmljZTogRWxlbWVudFNlcnZpY2UsXG5cdFx0QE9wdGlvbmFsKCkgcHJvdGVjdGVkIGFuaW1hdGlvbkZyYW1lU2VydmljZTogQW5pbWF0aW9uRnJhbWVTZXJ2aWNlID0gbnVsbCkge1xuXHRcdHN1cGVyKGVsZW1lbnRSZWYsIGVsZW1lbnRTZXJ2aWNlLCBhbmltYXRpb25GcmFtZVNlcnZpY2UpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIHdoZXRoZXIgdGhlcmUgaXMgYSB0ZW1wbGF0ZSBmb3IgdGhlIGBUb29sdGlwYCBjb250ZW50LlxuXHQgKi9cblx0b25EaWFsb2dJbml0KCkge1xuXHRcdHRoaXMuYWRkR2FwW1wiYm90dG9tXCJdID0gcG9zID0+IHtcblx0XHRcdGNvbnN0IGFkanVzdGVkT2Zmc2V0ID0gdGhpcy5nZXRBZGp1c3RPZmZzZXQoKTtcblx0XHRcdHJldHVybiBwb3NpdGlvbi5hZGRPZmZzZXQocG9zLCAzICsgYWRqdXN0ZWRPZmZzZXQudG9wLCAwICsgYWRqdXN0ZWRPZmZzZXQubGVmdCk7XG5cdFx0fTtcblx0XHR0aGlzLmFkZEdhcFtcInRvcFwiXSA9IHBvcyA9PiB7XG5cdFx0XHRjb25zdCBhZGp1c3RlZE9mZnNldCA9IHRoaXMuZ2V0QWRqdXN0T2Zmc2V0KCk7XG5cdFx0XHRyZXR1cm4gcG9zaXRpb24uYWRkT2Zmc2V0KHBvcywgLTEwICsgYWRqdXN0ZWRPZmZzZXQudG9wLCAwICsgYWRqdXN0ZWRPZmZzZXQubGVmdCk7XG5cdFx0fTtcblx0XHR0aGlzLmFkZEdhcFtcImxlZnRcIl0gPSBwb3MgPT4ge1xuXHRcdFx0Y29uc3QgYWRqdXN0ZWRPZmZzZXQgPSB0aGlzLmdldEFkanVzdE9mZnNldCgpO1xuXHRcdFx0cmV0dXJuIHBvc2l0aW9uLmFkZE9mZnNldChwb3MsIC0zICsgYWRqdXN0ZWRPZmZzZXQudG9wLCAtNiArIGFkanVzdGVkT2Zmc2V0LmxlZnQpO1xuXHRcdH07XG5cdFx0dGhpcy5hZGRHYXBbXCJyaWdodFwiXSA9IHBvcyA9PiB7XG5cdFx0XHRjb25zdCBhZGp1c3RlZE9mZnNldCA9IHRoaXMuZ2V0QWRqdXN0T2Zmc2V0KCk7XG5cdFx0XHRyZXR1cm4gcG9zaXRpb24uYWRkT2Zmc2V0KHBvcywgLTMgKyBhZGp1c3RlZE9mZnNldC50b3AsIDYgKyBhZGp1c3RlZE9mZnNldC5sZWZ0KTtcblx0XHR9O1xuXG5cdFx0dGhpcy5oYXNDb250ZW50VGVtcGxhdGUgPSB0aGlzLmRpYWxvZ0NvbmZpZy5jb250ZW50IGluc3RhbmNlb2YgVGVtcGxhdGVSZWY7XG5cdH1cblxuXHRnZXRBZGp1c3RPZmZzZXQoKSB7XG5cdFx0Y29uc3QgY2xvc2VzdFdpdGhQb3MgPSBjbG9zZXN0QXR0cihcInBvc2l0aW9uXCIsIFtcInJlbGF0aXZlXCIsIFwiZml4ZWRcIiwgXCJhYnNvbHV0ZVwiXSwgdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudCk7XG5cdFx0Y29uc3QgdG9wUG9zID0gY2xvc2VzdFdpdGhQb3MgPyBjbG9zZXN0V2l0aFBvcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKiAtMSA6IDA7XG5cdFx0Y29uc3QgbGVmdFBvcyA9IGNsb3Nlc3RXaXRoUG9zID8gY2xvc2VzdFdpdGhQb3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCAqIC0xIDogMDtcblxuXHRcdHJldHVybiB7dG9wOiB0b3BQb3MsIGxlZnQ6IGxlZnRQb3N9O1xuXHR9XG5cblx0YWZ0ZXJEaWFsb2dWaWV3SW5pdCgpIHtcblx0XHRjb25zdCBmb2N1c2FibGVFbGVtZW50cyA9IGdldEZvY3VzRWxlbWVudExpc3QodGhpcy5kaWFsb2cubmF0aXZlRWxlbWVudCk7XG5cdFx0aWYgKGZvY3VzYWJsZUVsZW1lbnRzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRoaXMucm9sZSA9IFwiZGlhbG9nXCI7XG5cdFx0XHRmb2N1c2FibGVFbGVtZW50c1swXS5mb2N1cygpO1xuXHRcdH1cblx0fVxufVxuIl19