/**
 *
 * carbon-angular v0.0.0 | tooltip.component.js
 *
 * Copyright 2014, 2021 IBM
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0

 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


import * as tslib_1 from "tslib";
import { Component, TemplateRef, HostBinding, ElementRef, Optional } from "@angular/core";
import { getFocusElementList } from "carbon-components-angular/common";
import { Dialog } from "../dialog.component";
import { position } from "@carbon/utils-position";
import { AnimationFrameService, ElementService } from "carbon-components-angular/utils";
import { closestAttr } from "carbon-components-angular/utils";
/**
 * Extend the `Dialog` component to create a tooltip for exposing content.
 */
var Tooltip = /** @class */ (function (_super) {
    tslib_1.__extends(Tooltip, _super);
    function Tooltip(elementRef, elementService, animationFrameService) {
        if (animationFrameService === void 0) { animationFrameService = null; }
        var _this = _super.call(this, elementRef, elementService, animationFrameService) || this;
        _this.elementRef = elementRef;
        _this.elementService = elementService;
        _this.animationFrameService = animationFrameService;
        _this.style = "inline-block";
        /**
         * Value is set to `true` if the `Tooltip` is to display a `TemplateRef` instead of a string.
         */
        _this.hasContentTemplate = false;
        /**
         * Sets the role of the tooltip. If there's no focusable content we leave it as a `tooltip`,
         * if there _is_ focusable content we switch to the interactive `dialog` role.
         */
        _this.role = "tooltip";
        return _this;
    }
    /**
     * Check whether there is a template for the `Tooltip` content.
     */
    Tooltip.prototype.onDialogInit = function () {
        var _this = this;
        this.addGap["bottom"] = function (pos) {
            var adjustedOffset = _this.getAdjustOffset();
            return position.addOffset(pos, 3 + adjustedOffset.top, 0 + adjustedOffset.left);
        };
        this.addGap["top"] = function (pos) {
            var adjustedOffset = _this.getAdjustOffset();
            return position.addOffset(pos, -10 + adjustedOffset.top, 0 + adjustedOffset.left);
        };
        this.addGap["left"] = function (pos) {
            var adjustedOffset = _this.getAdjustOffset();
            return position.addOffset(pos, -3 + adjustedOffset.top, -6 + adjustedOffset.left);
        };
        this.addGap["right"] = function (pos) {
            var adjustedOffset = _this.getAdjustOffset();
            return position.addOffset(pos, -3 + adjustedOffset.top, 6 + adjustedOffset.left);
        };
        this.hasContentTemplate = this.dialogConfig.content instanceof TemplateRef;
    };
    Tooltip.prototype.getAdjustOffset = function () {
        var closestWithPos = closestAttr("position", ["relative", "fixed", "absolute"], this.elementRef.nativeElement.parentElement);
        var topPos = closestWithPos ? closestWithPos.getBoundingClientRect().top * -1 : 0;
        var leftPos = closestWithPos ? closestWithPos.getBoundingClientRect().left * -1 : 0;
        return { top: topPos, left: leftPos };
    };
    Tooltip.prototype.afterDialogViewInit = function () {
        var focusableElements = getFocusElementList(this.dialog.nativeElement);
        if (focusableElements.length > 0) {
            this.role = "dialog";
            focusableElements[0].focus();
        }
    };
    Tooltip.decorators = [
        { type: Component, args: [{
                    selector: "ibm-tooltip",
                    template: "\n\t\t<div\n\t\t\t#dialog\n\t\t\t[id]=\"dialogConfig.compID\"\n\t\t\t[attr.role]=\"role\"\n\t\t\t[attr.data-floating-menu-direction]=\"placement\"\n\t\t\tclass=\"bx--tooltip bx--tooltip--shown\">\n\t\t\t<span class=\"bx--tooltip__caret\" aria-hidden=\"true\"></span>\n\t\t\t<ng-template\n\t\t\t\t\t*ngIf=\"hasContentTemplate\"\n\t\t\t\t\t[ngTemplateOutlet]=\"dialogConfig.content\"\n\t\t\t\t\t[ngTemplateOutletContext]=\"{tooltip: this}\">\n\t\t\t</ng-template>\n\t\t\t<p\n\t\t\t\t*ngIf=\"!hasContentTemplate\">\n\t\t\t\t{{dialogConfig.content}}\n\t\t\t</p>\n\t\t</div>\n\t\t"
                }] }
    ];
    /** @nocollapse */
    Tooltip.ctorParameters = function () { return [
        { type: ElementRef },
        { type: ElementService },
        { type: AnimationFrameService, decorators: [{ type: Optional }] }
    ]; };
    Tooltip.propDecorators = {
        style: [{ type: HostBinding, args: ["style.display",] }]
    };
    return Tooltip;
}(Dialog));
export { Tooltip };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9vbHRpcC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9jYXJib24tY29tcG9uZW50cy1hbmd1bGFyL2RpYWxvZy8iLCJzb3VyY2VzIjpbInRvb2x0aXAvdG9vbHRpcC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTixTQUFTLEVBQ1QsV0FBVyxFQUNYLFdBQVcsRUFDWCxVQUFVLEVBQ1YsUUFBUSxFQUNSLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBRXZFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUM3QyxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDbEQsT0FBTyxFQUFFLHFCQUFxQixFQUFFLGNBQWMsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ3hGLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUU5RDs7R0FFRztBQUNIO0lBc0I2QixtQ0FBTTtJQVlsQyxpQkFDVyxVQUFzQixFQUN0QixjQUE4QixFQUNsQixxQkFBbUQ7UUFBbkQsc0NBQUEsRUFBQSw0QkFBbUQ7UUFIMUUsWUFJQyxrQkFBTSxVQUFVLEVBQUUsY0FBYyxFQUFFLHFCQUFxQixDQUFDLFNBQ3hEO1FBSlUsZ0JBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsb0JBQWMsR0FBZCxjQUFjLENBQWdCO1FBQ2xCLDJCQUFxQixHQUFyQixxQkFBcUIsQ0FBOEI7UUFkNUMsV0FBSyxHQUFHLGNBQWMsQ0FBQztRQUNyRDs7V0FFRztRQUNJLHdCQUFrQixHQUFHLEtBQUssQ0FBQztRQUNsQzs7O1dBR0c7UUFDSSxVQUFJLEdBQUcsU0FBUyxDQUFDOztJQU94QixDQUFDO0lBRUQ7O09BRUc7SUFDSCw4QkFBWSxHQUFaO1FBQUEsaUJBbUJDO1FBbEJBLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsVUFBQSxHQUFHO1lBQzFCLElBQU0sY0FBYyxHQUFHLEtBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUM5QyxPQUFPLFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxjQUFjLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDakYsQ0FBQyxDQUFDO1FBQ0YsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxVQUFBLEdBQUc7WUFDdkIsSUFBTSxjQUFjLEdBQUcsS0FBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQzlDLE9BQU8sUUFBUSxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsY0FBYyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25GLENBQUMsQ0FBQztRQUNGLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsVUFBQSxHQUFHO1lBQ3hCLElBQU0sY0FBYyxHQUFHLEtBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUM5QyxPQUFPLFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLGNBQWMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25GLENBQUMsQ0FBQztRQUNGLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsVUFBQSxHQUFHO1lBQ3pCLElBQU0sY0FBYyxHQUFHLEtBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUM5QyxPQUFPLFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLGNBQWMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsRixDQUFDLENBQUM7UUFFRixJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLFlBQVksV0FBVyxDQUFDO0lBQzVFLENBQUM7SUFFRCxpQ0FBZSxHQUFmO1FBQ0MsSUFBTSxjQUFjLEdBQUcsV0FBVyxDQUFDLFVBQVUsRUFBRSxDQUFDLFVBQVUsRUFBRSxPQUFPLEVBQUUsVUFBVSxDQUFDLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDL0gsSUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwRixJQUFNLE9BQU8sR0FBRyxjQUFjLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRXRGLE9BQU8sRUFBQyxHQUFHLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQscUNBQW1CLEdBQW5CO1FBQ0MsSUFBTSxpQkFBaUIsR0FBRyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ3pFLElBQUksaUJBQWlCLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUNqQyxJQUFJLENBQUMsSUFBSSxHQUFHLFFBQVEsQ0FBQztZQUNyQixpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUM3QjtJQUNGLENBQUM7O2dCQS9FRCxTQUFTLFNBQUM7b0JBQ1YsUUFBUSxFQUFFLGFBQWE7b0JBQ3ZCLFFBQVEsRUFBRSxpa0JBa0JSO2lCQUNGOzs7O2dCQWxDQSxVQUFVO2dCQU9xQixjQUFjO2dCQUFyQyxxQkFBcUIsdUJBMkMzQixRQUFROzs7d0JBZFQsV0FBVyxTQUFDLGVBQWU7O0lBeUQ3QixjQUFDO0NBQUEsQUFoRkQsQ0FzQjZCLE1BQU0sR0EwRGxDO1NBMURZLE9BQU8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuXHRDb21wb25lbnQsXG5cdFRlbXBsYXRlUmVmLFxuXHRIb3N0QmluZGluZyxcblx0RWxlbWVudFJlZixcblx0T3B0aW9uYWxcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IGdldEZvY3VzRWxlbWVudExpc3QgfSBmcm9tIFwiY2FyYm9uLWNvbXBvbmVudHMtYW5ndWxhci9jb21tb25cIjtcblxuaW1wb3J0IHsgRGlhbG9nIH0gZnJvbSBcIi4uL2RpYWxvZy5jb21wb25lbnRcIjtcbmltcG9ydCB7IHBvc2l0aW9uIH0gZnJvbSBcIkBjYXJib24vdXRpbHMtcG9zaXRpb25cIjtcbmltcG9ydCB7IEFuaW1hdGlvbkZyYW1lU2VydmljZSwgRWxlbWVudFNlcnZpY2UgfSBmcm9tIFwiY2FyYm9uLWNvbXBvbmVudHMtYW5ndWxhci91dGlsc1wiO1xuaW1wb3J0IHsgY2xvc2VzdEF0dHIgfSBmcm9tIFwiY2FyYm9uLWNvbXBvbmVudHMtYW5ndWxhci91dGlsc1wiO1xuXG4vKipcbiAqIEV4dGVuZCB0aGUgYERpYWxvZ2AgY29tcG9uZW50IHRvIGNyZWF0ZSBhIHRvb2x0aXAgZm9yIGV4cG9zaW5nIGNvbnRlbnQuXG4gKi9cbkBDb21wb25lbnQoe1xuXHRzZWxlY3RvcjogXCJpYm0tdG9vbHRpcFwiLFxuXHR0ZW1wbGF0ZTogYFxuXHRcdDxkaXZcblx0XHRcdCNkaWFsb2dcblx0XHRcdFtpZF09XCJkaWFsb2dDb25maWcuY29tcElEXCJcblx0XHRcdFthdHRyLnJvbGVdPVwicm9sZVwiXG5cdFx0XHRbYXR0ci5kYXRhLWZsb2F0aW5nLW1lbnUtZGlyZWN0aW9uXT1cInBsYWNlbWVudFwiXG5cdFx0XHRjbGFzcz1cImJ4LS10b29sdGlwIGJ4LS10b29sdGlwLS1zaG93blwiPlxuXHRcdFx0PHNwYW4gY2xhc3M9XCJieC0tdG9vbHRpcF9fY2FyZXRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L3NwYW4+XG5cdFx0XHQ8bmctdGVtcGxhdGVcblx0XHRcdFx0XHQqbmdJZj1cImhhc0NvbnRlbnRUZW1wbGF0ZVwiXG5cdFx0XHRcdFx0W25nVGVtcGxhdGVPdXRsZXRdPVwiZGlhbG9nQ29uZmlnLmNvbnRlbnRcIlxuXHRcdFx0XHRcdFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7dG9vbHRpcDogdGhpc31cIj5cblx0XHRcdDwvbmctdGVtcGxhdGU+XG5cdFx0XHQ8cFxuXHRcdFx0XHQqbmdJZj1cIiFoYXNDb250ZW50VGVtcGxhdGVcIj5cblx0XHRcdFx0e3tkaWFsb2dDb25maWcuY29udGVudH19XG5cdFx0XHQ8L3A+XG5cdFx0PC9kaXY+XG5cdFx0YFxufSlcbmV4cG9ydCBjbGFzcyBUb29sdGlwIGV4dGVuZHMgRGlhbG9nIHtcblx0QEhvc3RCaW5kaW5nKFwic3R5bGUuZGlzcGxheVwiKSBzdHlsZSA9IFwiaW5saW5lLWJsb2NrXCI7XG5cdC8qKlxuXHQgKiBWYWx1ZSBpcyBzZXQgdG8gYHRydWVgIGlmIHRoZSBgVG9vbHRpcGAgaXMgdG8gZGlzcGxheSBhIGBUZW1wbGF0ZVJlZmAgaW5zdGVhZCBvZiBhIHN0cmluZy5cblx0ICovXG5cdHB1YmxpYyBoYXNDb250ZW50VGVtcGxhdGUgPSBmYWxzZTtcblx0LyoqXG5cdCAqIFNldHMgdGhlIHJvbGUgb2YgdGhlIHRvb2x0aXAuIElmIHRoZXJlJ3Mgbm8gZm9jdXNhYmxlIGNvbnRlbnQgd2UgbGVhdmUgaXQgYXMgYSBgdG9vbHRpcGAsXG5cdCAqIGlmIHRoZXJlIF9pc18gZm9jdXNhYmxlIGNvbnRlbnQgd2Ugc3dpdGNoIHRvIHRoZSBpbnRlcmFjdGl2ZSBgZGlhbG9nYCByb2xlLlxuXHQgKi9cblx0cHVibGljIHJvbGUgPSBcInRvb2x0aXBcIjtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcm90ZWN0ZWQgZWxlbWVudFJlZjogRWxlbWVudFJlZixcblx0XHRwcm90ZWN0ZWQgZWxlbWVudFNlcnZpY2U6IEVsZW1lbnRTZXJ2aWNlLFxuXHRcdEBPcHRpb25hbCgpIHByb3RlY3RlZCBhbmltYXRpb25GcmFtZVNlcnZpY2U6IEFuaW1hdGlvbkZyYW1lU2VydmljZSA9IG51bGwpIHtcblx0XHRzdXBlcihlbGVtZW50UmVmLCBlbGVtZW50U2VydmljZSwgYW5pbWF0aW9uRnJhbWVTZXJ2aWNlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayB3aGV0aGVyIHRoZXJlIGlzIGEgdGVtcGxhdGUgZm9yIHRoZSBgVG9vbHRpcGAgY29udGVudC5cblx0ICovXG5cdG9uRGlhbG9nSW5pdCgpIHtcblx0XHR0aGlzLmFkZEdhcFtcImJvdHRvbVwiXSA9IHBvcyA9PiB7XG5cdFx0XHRjb25zdCBhZGp1c3RlZE9mZnNldCA9IHRoaXMuZ2V0QWRqdXN0T2Zmc2V0KCk7XG5cdFx0XHRyZXR1cm4gcG9zaXRpb24uYWRkT2Zmc2V0KHBvcywgMyArIGFkanVzdGVkT2Zmc2V0LnRvcCwgMCArIGFkanVzdGVkT2Zmc2V0LmxlZnQpO1xuXHRcdH07XG5cdFx0dGhpcy5hZGRHYXBbXCJ0b3BcIl0gPSBwb3MgPT4ge1xuXHRcdFx0Y29uc3QgYWRqdXN0ZWRPZmZzZXQgPSB0aGlzLmdldEFkanVzdE9mZnNldCgpO1xuXHRcdFx0cmV0dXJuIHBvc2l0aW9uLmFkZE9mZnNldChwb3MsIC0xMCArIGFkanVzdGVkT2Zmc2V0LnRvcCwgMCArIGFkanVzdGVkT2Zmc2V0LmxlZnQpO1xuXHRcdH07XG5cdFx0dGhpcy5hZGRHYXBbXCJsZWZ0XCJdID0gcG9zID0+IHtcblx0XHRcdGNvbnN0IGFkanVzdGVkT2Zmc2V0ID0gdGhpcy5nZXRBZGp1c3RPZmZzZXQoKTtcblx0XHRcdHJldHVybiBwb3NpdGlvbi5hZGRPZmZzZXQocG9zLCAtMyArIGFkanVzdGVkT2Zmc2V0LnRvcCwgLTYgKyBhZGp1c3RlZE9mZnNldC5sZWZ0KTtcblx0XHR9O1xuXHRcdHRoaXMuYWRkR2FwW1wicmlnaHRcIl0gPSBwb3MgPT4ge1xuXHRcdFx0Y29uc3QgYWRqdXN0ZWRPZmZzZXQgPSB0aGlzLmdldEFkanVzdE9mZnNldCgpO1xuXHRcdFx0cmV0dXJuIHBvc2l0aW9uLmFkZE9mZnNldChwb3MsIC0zICsgYWRqdXN0ZWRPZmZzZXQudG9wLCA2ICsgYWRqdXN0ZWRPZmZzZXQubGVmdCk7XG5cdFx0fTtcblxuXHRcdHRoaXMuaGFzQ29udGVudFRlbXBsYXRlID0gdGhpcy5kaWFsb2dDb25maWcuY29udGVudCBpbnN0YW5jZW9mIFRlbXBsYXRlUmVmO1xuXHR9XG5cblx0Z2V0QWRqdXN0T2Zmc2V0KCkge1xuXHRcdGNvbnN0IGNsb3Nlc3RXaXRoUG9zID0gY2xvc2VzdEF0dHIoXCJwb3NpdGlvblwiLCBbXCJyZWxhdGl2ZVwiLCBcImZpeGVkXCIsIFwiYWJzb2x1dGVcIl0sIHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnBhcmVudEVsZW1lbnQpO1xuXHRcdGNvbnN0IHRvcFBvcyA9IGNsb3Nlc3RXaXRoUG9zID8gY2xvc2VzdFdpdGhQb3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICogLTEgOiAwO1xuXHRcdGNvbnN0IGxlZnRQb3MgPSBjbG9zZXN0V2l0aFBvcyA/IGNsb3Nlc3RXaXRoUG9zLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgKiAtMSA6IDA7XG5cblx0XHRyZXR1cm4ge3RvcDogdG9wUG9zLCBsZWZ0OiBsZWZ0UG9zfTtcblx0fVxuXG5cdGFmdGVyRGlhbG9nVmlld0luaXQoKSB7XG5cdFx0Y29uc3QgZm9jdXNhYmxlRWxlbWVudHMgPSBnZXRGb2N1c0VsZW1lbnRMaXN0KHRoaXMuZGlhbG9nLm5hdGl2ZUVsZW1lbnQpO1xuXHRcdGlmIChmb2N1c2FibGVFbGVtZW50cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0aGlzLnJvbGUgPSBcImRpYWxvZ1wiO1xuXHRcdFx0Zm9jdXNhYmxlRWxlbWVudHNbMF0uZm9jdXMoKTtcblx0XHR9XG5cdH1cbn1cbiJdfQ==